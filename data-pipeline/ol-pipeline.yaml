georgian-budget-pipeline:
  title: Georgian Budget Data Processing Pipeline
  description: Fetches, cleans and processes Georgian government budget data from geostat.ge
  environment:
    DEBUG: true
  pipeline:
    - run: processors/fetch_georgian_budget
      parameters:
        output_name: "raw_budget_data"
    
    # Step 2: Clean and normalize the Excel data
    - run: processors/clean_georgian_excel
      parameters:
        resource: "raw_budget_data"
        header_row: 1
        encoding: "utf-8"
    
    # Step 3: Translate Georgian headers to English
    - run: processors/translate_headers
      parameters:
        resource: "raw_budget_data"
        translation_file: "translations/headers.csv"
    
    # Step 4: Normalize department names and codes
    - run: processors/normalize_departments
      parameters:
        resource: "raw_budget_data"
        department_mapping: "translations/departments.csv"
    
    # Step 5: Convert amounts and handle currency
    - run: processors/process_amounts
      parameters:
        resource: "raw_budget_data"
        currency: "GEL"
        scale_factor: 1000  # Convert to thousands
    
    # Step 6: Add metadata and validate data
    - run: processors/add_metadata
      parameters:
        name: "georgian-budget"
        title: "Georgian Government Budget Data"
        description: "Processed budget data from Georgian National Statistics Office"
        version: "1.0.0"
        source: "geostat.ge"
    
    # Step 7: Export processed data
    - run: dump_to_path
      parameters:
        out-path: "../data/processed"
        format: "csv"
        pretty-descriptor: true
    
    # Step 8: Create JSON API format  
    - run: dump_to_path
      parameters:
        out-path: "../data/processed"
        format: "json"
        pretty-descriptor: true

# Historical data pipeline for multiple years (commented out for testing)
# georgian-budget-historical:
#   title: Historical Georgian Budget Data Pipeline
#   description: Processes budget data for multiple years
#   pipeline:
#     - run: fetch_historical_budgets
#       parameters:
#         years: [2020, 2021, 2022, 2023, 2024]
#         base_url: "https://geostat.ge/media"
#     
#     - run: process_historical_data
#       parameters:
#         normalize_years: true
#         inflation_adjust: false
#     
#     - run: dump_to_path
#       parameters:
#         out-path: "../data/historical"
#         format: "csv" 